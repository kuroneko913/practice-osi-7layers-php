# OSI参照モデル - 第2層（データリンク層）のまとめ（再発明体験より）

## ✅ この層でできるようになったこと

### 1. フレームという単位でデータを送れるようになった
- 「どこからどこまでが1つのデータか？」を構造化できる
- 0と1のビット列を、意味のあるまとまり（= フレーム）として扱える

### 2. 宛先（誰に送るか）と送信元（誰から来たか）を指定できる
- `DEST`（宛先）と `SRC`（送信元）のMACアドレスによる識別
- 宛先が自分のMACでなければ破棄 → **自分宛だけ受け取る仕組み**

### 3. プロトコルの種別（TYPE）で上位の振り分けができる
- `TYPE: 0x0800` なら IP、`0x0806` なら ARP など
- 同じ伝送線上で複数のプロトコルを**多重化（multiplex）**できる

### 4. データの破損を検出できる（CRC）
- 送信時に `crc32()` でフレームの整合性チェック用値を付加
- 受信時に再計算して比較 → 不一致なら破棄
- これにより**一定の信頼性**が得られる（再送はまだ無い）

### 5. 最小/最大フレーム長の理解と対応
- 最小：46バイト（衝突検出のため。イーサネットの仕様）
- 最大：1500バイト（NICやスイッチの処理限界と再送コスト考慮）

### 6. インターネットがなくても“同じネットワーク内”では通信できる
- NIC（Network Interface Card）があることで、物理的に接続されていれば通信可能
- IPすら不要で、**MACアドレスだけで通信できる世界**を体験

---

## 💡 この層の裏にあるリアルな仕組み

| 実装項目 | 現実ではどこにある？ |
|----------|------------------------|
| フレーム構築 | NIC内部のMACチップ |
| DEST / SRC | MACアドレス（Ether） |
| CRCチェック | NICでのハード計算 |
| 宛先判定 | NICが「自分宛か？」を自動判断 |
| TYPE振り分け | OSのネットワークスタックで受信先決定 |

---

## ⚠️ この層だけではできないこと（限界）

| やりたいこと | なぜ無理？ |
|--------------|------------|
| ネットワークをまたいで通信 | ルーティング機能がない |
| IPアドレス指定で通信 | IPの概念がない（MACしかわからない） |
| データの順序制御、再送、保証 | TCPなど第4層以降が必要 |
| インターネット接続 | ゲートウェイやDNSを扱えない |

---

## 🎯 一言でまとめるなら：

> 第2層は「つながっている相手とだけ、誰に送るかを識別しながら、最小限の信頼性でフレーム単位の通信ができる層」。  
> それだけでもローカルネットワークは成立するが、**“ネットワークの外”には届かない**。

---

## ✅ 次に向かうなら…

次は **第3層（ネットワーク層）** に進み、  
- IPアドレスの導入  
- サブネットとルーティング  
- ネットワークの分離と接続（ゲートウェイ）

など、**ネットワークをまたぐ世界**を扱えるようにする。
